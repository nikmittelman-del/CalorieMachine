<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>מערכת מחשבון קלוריות ומאקרונוטריינטים למאמנים</title>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css"> 
</head>
<body>

    <div class="main-container">
        <h1>מערכת ניהול תזונה למאמנים</h1>

        <div class="card client-management">
            <h2>ניהול פרופיל לקוח</h2>
            <div class="form-group">
                <label for="client-name">שם לקוח:</label>
                <input type="text" id="client-name" value="" placeholder="הזן שם לקוח חדש">
            </div>
            <div class="action-buttons">
                <button id="save-profile-btn" class="action-btn primary-btn">שמור פרופיל</button>
                <button id="load-profile-btn" class="action-btn secondary-btn">טען פרופיל</button>
                <button id="new-client-btn" class="action-btn secondary-btn">לקוח חדש</button>
            </div>
            <div class="form-group hidden" id="client-list-container">
                <select id="client-list"></select>
            </div>
        </div>

        <div class="card">
            <form id="calorie-form">
                <div class="form-group">
                    <label for="gender">מגדר:</label>
                    <select id="gender" required>
                        <option value="male">זכר</option>
                        <option value="female">נקבה</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="weight">משקל (ק"ג):</label>
                    <input type="number" id="weight" step="0.1" min="1" required>
                </div>

                <div class="form-group">
                    <label for="height">גובה (ס"מ):</label>
                    <input type="number" id="height" min="1" required>
                </div>
                
                <div class="form-group">
                    <label for="age">גיל (שנים):</label>
                    <input type="number" id="age" min="1" required>
                </div>

                <div class="form-group">
                    <label for="body-fat">אחוז שומן (אופציונלי):</label>
                    <input type="number" id="body-fat" step="0.1" min="1" max="60" placeholder="להזנת Katch-McArdle">
                </div>

                <div class="form-group">
                    <label for="activity">רמת פעילות:</label>
                    <select id="activity" required>
                        <option value="sedentary">ישיבתי (1.2) - משרד, מעט תנועה</option>
                        <option value="light">קל (1.375) - אימון קל 1-3 בשבוע</option>
                        <option value="moderate">בינוני (1.55) - אימון בינוני 3-5 בשבוע</option>
                        <option value="high">גבוה (1.725) - אימון אינטנסיבי 6-7 בשבוע</option>
                        <option value="extreme">קיצוני (1.9) - אימון כפול / עבודה פיזית</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="goal-type">יעד קלורי:</label>
                    <select id="goal-type" required>
                        <option value="deficit_light">חיטוב קל (-250 קלוריות)</option>
                        <option value="deficit_medium">חיטוב בינוני (-500 קלוריות)</option>
                        <option value="deficit_high">חיטוב אגרסיבי (-750 קלוריות)</option>
                        <option value="maintenance">משקל יעד (אחזקה)</option>
                        <option value="surplus_medium">מסה בינונית (+250 קלוריות)</option>
                        <option value="surplus_high">מסה גבוהה (+500 קלוריות)</option>
                        <option value="custom">הזנת יעד קלורי מדויק</option> 
                    </select>
                </div>

                <div class="form-group hidden" id="custom-goal-container">
                    <label for="custom-goal">יעד קלורי מדויק (סה"כ):</label>
                    <input type="number" id="custom-goal" placeholder="הזן קלוריות יומיות">
                </div>


                <div class="form-group">
                    <label for="macro-split">חלוקת מאקרו:</label>
                    <select id="macro-split" required>
                        <option value="default_p">ברירת מחדל (35% חלבון / 25% שומן / 40% פחמימה)</option>
                        <option value="keto">קיטו / דל פחמימה (30% חלבון / 60% שומן / 10% פחמימה)</option>
                        <option value="custom_p">הזנת אחוזים מותאמים אישית</option>
                        <option value="custom_gpk">חלוקה מקצועית (חלבון/שומן לפי ק"ג)</option> </select>
                </div>
                
                <div class="form-group custom-macro-group hidden" id="custom-macro-container">
                    <label>אחוזי מאקרו מותאמים אישית (סך הכל 100%):</label>
                    <div class="macro-custom-inputs">
                        <input type="number" id="custom-p-percent" step="1" min="1" max="100" placeholder="חלבון (%)" value="35">
                        <input type="number" id="custom-f-percent" step="1" min="1" max="100" placeholder="שומן (%)" value="25">
                        <input type="number" id="custom-c-percent" step="1" min="1" max="100" placeholder="פחמימה (%)" value="40">
                    </div>
                </div>

                 <div class="form-group custom-macro-group hidden" id="custom-gpk-container">
                    <label>חלוקה מקצועית (גרם לק"ג):</label>
                    <div class="macro-custom-inputs">
                        <input type="number" id="custom-p-gpk" step="0.1" min="0.5" max="5" placeholder="חלבון (גרם/קג)" value="2.0">
                        <input type="number" id="custom-f-gpk" step="0.1" min="0.3" max="2" placeholder="שומן (גרם/קג)" value="0.8">
                    </div>
                    <p class="explanation-text">פחמימה תחושב אוטומטית כהשלמה קלורית.</p>
                </div>


                <div id="error-message" class="message error hidden"></div>
                <div id="warning-message" class="message warning hidden">
                    <p id="warning-text"></p>
                </div>

                <div class="form-actions">
                    <button type="button" id="calculate-btn" class="primary-btn">חשב קלוריות ומאקרו</button>
                    <button type="button" id="reset-btn" class="secondary-btn">איפוס</button>
                </div>
            </form>
        </div>

        <div id="results" class="card hidden">
            <h2>תוצאות החישוב</h2>
            
            <table class="results-table">
                <tr>
                    <th>מדד</th>
                    <th>חישוב Mifflin-St Jeor</th>
                    <th id="katch-header">חישוב Katch-McArdle</th>
                </tr>
                <tr>
                    <td>BMI</td>
                    <td colspan="2" id="bmi-result">--</td>
                </tr>
                <tr>
                    <td>**יעד שבועי משוער**</td>
                    <td colspan="2" id="weekly-goal-result" class="highlight-result">--</td>
                </tr>
                <tr>
                    <td>BMR</td>
                    <td id="m-bmr-result">--</td>
                    <td id="k-bmr-result">--</td>
                </tr>
                <tr>
                    <td>TDEE (קלוריות תחזוקה)</td>
                    <td id="m-tdee-result">--</td>
                    <td id="k-tdee-result">--</td>
                </tr>
                <tr>
                    <td>**יעד קלורי יומי**</td>
                    <td id="m-result" class="highlight-result">--</td>
                    <td id="k-result" class="highlight-result">--</td>
                </tr>
            </table>
            
            <div id="bmi-recommendation" class="message hidden" style="margin-top: 20px;"></div>

            <h3>חלוקת מאקרונוטריינטים מומלצת (לפי יעד קלורי)</h3>
            <p class="explanation-text">החישוב מתבסס על יעד הקלוריות מ-Mifflin-St Jeor (או Katch-McArdle אם נבחר).</p>
            <table class="macro-table">
                <tr>
                    <th>נוסחה</th>
                    <th>סך קלוריות</th>
                    <th>חלבון (גרם)</th>
                    <th>שומן (גרם)</th>
                    <th>פחמימה (גרם)</th>
                    <th>חלבון (%)</th>
                    <th>שומן (%)</th>
                    <th>פחמימה (%)</th>
                </tr>
                <tr>
                    <td>Mifflin</td>
                    <td id="m-result-macro">--</td>
                    <td id="m_p_g">--</td>
                    <td id="m_f_g">--</td>
                    <td id="m_c_g">--</td>
                    <td id="m_p_p">--</td>
                    <td id="m_f_p">--</td>
                    <td id="m_c_p">--</td>
                </tr>
                <tr id="katch-row">
                    <td>Katch</td>
                    <td id="k-result-macro">--</td>
                    <td id="k_p_g">--</td>
                    <td id="k_f_g">--</td>
                    <td id="k_c_g">--</td>
                    <td id="k_p_p">--</td>
                    <td id="k_f_p">--</td>
                    <td id="k_c_p">--</td>
                </tr>
            </table>

            <div class="form-actions result-actions">
                <button id="save-calculation-btn" class="action-btn primary-btn">שמור חישוב להיסטוריה</button>
                <button id="generate-report-btn" class="action-btn secondary-btn">יצירת דוח מקצועי</button>
                <button id="open-history-btn" class="action-btn secondary-btn">צפה בהיסטוריה</button>
            </div>
        </div>
        
        <div id="history-section" class="card hidden">
            <h2>היסטוריית חישובים עבור <span id="history-client-name">--</span></h2>
            <p id="history-message" class="explanation-text">עדיין אין חישובים שמורים עבור לקוח זה.</p>
            <table class="history-table hidden">
                <thead>
                    <tr>
                        <th>תאריך</th>
                        <th>משקל (ק"ג)</th>
                        <th>אחוזי שומן (%)</th>
                        <th>TDEE (קלוריות)</th>
                        <th>יעד קלורי (קלוריות)</th>
                        <th>פירוט מאקרו (P/F/C)</th>
                    </tr>
                </thead>
                <tbody id="history-table-body">
                    </tbody>
            </table>
        </div>


    </div>
    
    <footer id="footer-credits">
        <p>זכויות יוצרים-GS-BM-איננו יועץ תזונה או מחליף.יש להשתמש בשיקול רב</p>
        <div class="footer-links">
            <button id="open-about-modal-btn" class="action-btn secondary-btn small-btn">אודות ונוסחאות</button>
        </div>
    </footer>

    <div id="about-modal-container" class="modal-container hidden">
        <div class="modal-content">
            <span class="close-btn" id="about-close-btn">&times;</span>
            <div id="about-content"></div>
            <div class="action-buttons" style="margin-top: 20px;">
                <button id="activity-info-btn" class="action-btn primary-btn">צפה במקדמי פעילות</button>
            </div>
        </div>
    </div>

    <div id="modal-container" class="modal-container hidden">
        <div class="modal-content">
            <span class="close-btn" id="activity-close-btn">&times;</span>
            <div id="activity-factors">
                <h2>מקדמי פעילות (Activity Multipliers)</h2>
                <p>להלן מקדמי הפעילות המשמשים לחישוב ה-TDEE:</p>
                <ul>
                    <li>**ישיבתי (Sedentary):** 1.2</li>
                    <li>**קל (Light):** 1.375</li>
                    <li>**בינוני (Moderate):** 1.55</li>
                    <li>**גבוה (High):** 1.725</li>
                    <li>**קיצוני (Extreme):** 1.9</li>
                </ul>
                <p class="explanation-text">כמאמן, אתה יכול לבחור מקדם קרוב יותר למציאות אם אתה חושב שהלקוח ממעיט או מגזים ברמת הפעילות שלו.</p>
            </div>
        </div>
    </div>
    
    <div id="share-modal-container" class="modal-container hidden">
        <div class="modal-content">
            <span class="close-btn" id="share-close-btn">&times;</span>
            <h2>דוח תזונה מקצועי</h2>
            <div id="report-output">
                </div>
            <div class="form-actions" style="margin-top: 20px;">
                <button id="print-report-btn" class="action-btn primary-btn">הדפסת דוח (PDF)</button>
            </div>
        </div>
    </div>


    <script src="script.js"></script>
    <script>
        // טעינת תוכן about.html לתוך המודאל
        fetch('about.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('about-content').innerHTML = data;
            });
    </script>
</body>
</html>